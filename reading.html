<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <meta http-equiv="X-UA-Compatible" content="IE=edge">
 <!-- For Mobile Devices -->
 <meta name="viewport" content="width=device-width, initial-scale=1">
 <!-- Loading Lato Font -->
 <link href='https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic' rel='stylesheet' type='text/css'>
 <!-- Loading Font Awesome -->
 <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
 <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
 <meta name="generator" content="Doxygen 1.8.10"/>
 <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-88338608-1', 'auto');
  ga('send', 'pageview');
</script>
 <title>Reading a binary InterOp file</title>
 <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
 <script type="text/javascript" src="dynsections.js"></script>
 <link href="doxygen.css" rel="stylesheet" type="text/css" />
 <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
 <link rel="stylesheet" href="bootstrap3/css/bootstrap.min.css">
 <link href="bootstrap3/css/sticky-footer-navbar.css" rel="stylesheet">
 <script src="bootstrap3/js/bootstrap.min.js"></script>
 <script type="text/javascript" src="doxy-boot.js"></script>
</head>
<body screen_capture_injected="true">
<nav class="navbar navbar-inverse" role="navigation">
 <div class="container">
  <div class="navbar-header">
   <a class="navbar-brand" href="https://www.illumina.com/"><img style='margin-top: -8px !important;height: 40px !important;' src='ILLUMINA_LOGO_RGB_new_200_45.png' /></a>
   <a class="navbar-brand">InterOp <span style="font-size: 10pt">v1.2.3</span>  </a>
  </div>
  <div class="collapse navbar-collapse">
   <!-- Left -->
   <ul class="nav navbar-nav adjust-right">
    <li><a href="https://github.com/Illumina/interop">Code</a></li>
    <li><a href="https://github.com/Illumina/interop/issues">Issues</a></li>
    <li><a href="https://github.com/Illumina/interop/releases/latest">Download</a></li>
   </ul>
  </div><!--/.nav-collapse -->
 </div>
</nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
 <div class="content" id="content">
  <div class="container">
   <div class="row">
    <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
     <div style="margin-bottom: 15px;">
      <!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li class="current"><a href="pages.html"><span>Index</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="examples.html">Examples</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Reading a binary InterOp file </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Reading a binary Interop file is really just two lines of code, but all sorts of unexpected situations may arise. This example shows you how to write bullet proof code to read an Illumina InterOp file.</p>
<h2>Simple method</h2>
<h2>C++ </h2>
<p>Shows how to read a single metric set using run_metrics</p>
<div class="fragment"><div class="line">    std::vector&lt;unsigned char&gt; valid_to_load(<a class="code" href="group__constants.html#gga33317d0a3714d7554ea16619be6dc55caedc0f211247418c1af2cbec3bb04f1f5">constants::MetricCount</a>, 0);</div>
<div class="line">    valid_to_load[<a class="code" href="group__constants.html#gga33317d0a3714d7554ea16619be6dc55caa53ab217f1572250a530c8c2b3c820cf">constants::Q</a>]=1;</div>
<div class="line">    run_metrics metrics;</div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">        metrics.read(filename, valid_to_load);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(<span class="keyword">const</span> std::exception&amp; ex)</div>
<div class="line">    {</div>
<div class="line">        std::cerr &lt;&lt; ex.what() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    metric_set&lt;q_metric&gt;&amp; <a class="code" href="q__metrics__test_8cpp.html#ae67c7f9b5f34e523f84fe9dd927c9893">q_metric_set</a> = metrics.get&lt;model::metrics::q_metric&gt;();</div>
</div><!-- fragment --> <h2>C# </h2>
<p>Shows how to read all metrics required by the imaging tab in SAV</p>
<div class="fragment"><div class="line">        run_metrics metrics = <span class="keyword">new</span> run_metrics();</div>
<div class="line">        uchar_vector interopsToLoad = <span class="keyword">new</span> uchar_vector();</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Load only the metrics required by imaging table</span></div>
<div class="line">        c_csharp_table.list_imaging_table_metrics_to_load(interopsToLoad);</div>
<div class="line">        metrics.read(args[0], interopsToLoad);</div>
</div><!-- fragment --> <h2>Advanced method</h2>
<p>Not recommneded for most users.</p>
<h3>C++</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="metric__set_8h.html">interop/model/metric_base/metric_set.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="model_2metrics_2tile__metric_8h.html">interop/model/metrics/tile_metric.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="metric__file__stream_8h.html">interop/io/metric_file_stream.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceillumina_1_1interop_1_1model_1_1metric__base.html">illumina::interop::model::metric_base</a>;</div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceillumina_1_1interop_1_1model_1_1metrics.html">illumina::interop::model::metrics</a>;</div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceillumina_1_1interop_1_1io.html">illumina::interop::io</a>;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="example1_8cpp.html#aa70d1ba11886aca18ab41b130d3b3310">check_args</a>(<span class="keywordtype">int</span> argc);</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="aggregate_8cpp.html#a217dbf8b442f20279ea00b898af96f52">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line">    <span class="keywordflow">if</span>((ret = <a class="code" href="example1_8cpp.html#aa70d1ba11886aca18ab41b130d3b3310">check_args</a>(argc)) != 0) <span class="keywordflow">return</span> ret;</div>
<div class="line">    <a class="code" href="classillumina_1_1interop_1_1model_1_1metric__base_1_1metric__set.html">metric_set&lt;tile_metric&gt;</a> <a class="code" href="tile__metrics__test_8cpp.html#a5c0b9d76568fafd7fb84895e4b5b0c3a">tile_metric_set</a>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        <a class="code" href="group__file__io.html#gaa0f95ce88cda948fb40abe52723e7d57">read_interop</a>(argv[1], tile_metric_set);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(<span class="keyword">const</span> <a class="code" href="structillumina_1_1interop_1_1io_1_1incomplete__file__exception.html">incomplete_file_exception</a>&amp;){}<span class="comment">// Ignore incomplete files</span></div>
<div class="line">    <span class="keywordflow">catch</span>(<span class="keyword">const</span> <a class="code" href="structillumina_1_1interop_1_1io_1_1bad__format__exception.html">bad_format_exception</a>&amp; ex) <span class="comment">// Something catastrophic happened to the file</span></div>
<div class="line">    {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;InterOp did not have the expected format: &quot;</span> &lt;&lt; ex.what() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span>(<span class="keyword">const</span> <a class="code" href="structillumina_1_1interop_1_1io_1_1file__not__found__exception.html">file_not_found_exception</a>&amp; ex)</div>
<div class="line">    {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Count not find InterOp file: &quot;</span> &lt;&lt; ex.what() &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Tile metric set contains &quot;</span> &lt;&lt; tile_metric_set.<a class="code" href="classillumina_1_1interop_1_1model_1_1metric__base_1_1metric__set.html#aac782da1f912bceb5d8ad00c8dc892ac">size</a>() &lt;&lt; <span class="stringliteral">&quot; metrics&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --> <h3>C</h3>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_illumina.html">Illumina</a>.<a class="code" href="namespace_illumina_1_1_inter_op.html">InterOp</a>.Run;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_illumina.html">Illumina</a>.<a class="code" href="namespace_illumina_1_1_inter_op.html">InterOp</a>.Metrics;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_illumina.html">Illumina</a>.<a class="code" href="namespace_illumina_1_1_inter_op.html">InterOp</a>.Comm;</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span>Example1</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">int</span> Main(<span class="keywordtype">string</span>[] args)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (args.Length != 1)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (args.Length &lt; 1)</div>
<div class="line">                Console.WriteLine (<span class="stringliteral">&quot;No run folder&quot;</span>);</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                Console.WriteLine (<span class="stringliteral">&quot;Too many arguments&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        base_tile_metrics tile_metric_set = <span class="keyword">new</span> base_tile_metrics ();</div>
<div class="line">        <span class="keywordflow">try</span></div>
<div class="line">        {</div>
<div class="line">            c_csharp_comm.read_interop (args [0], tile_metric_set);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(incomplete_file_exception){}</div>
<div class="line">        <span class="keywordflow">catch</span>(file_not_found_exception ex)</div>
<div class="line">        {</div>
<div class="line"></div>
<div class="line">            Console.WriteLine(<span class="stringliteral">&quot;File not found: &quot;</span>+args [0]);</div>
<div class="line">            Console.WriteLine (ex);</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">catch</span>(bad_format_exception ex)</div>
<div class="line">        {</div>
<div class="line">            Console.WriteLine (ex);</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">        Console.Write (<span class="stringliteral">&quot;Tile metric set contains {0} metrics&quot;</span>, tile_metric_set.size());</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --></div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/>
</body>
</html>
